---
alwaysApply: true
---

# React Native SSL Manager - Project Structure

This project has been restructured to support both React Native CLI and Expo with shared logic.

## Complete Directory Structure

```
react-native-ssl-manager/
├── android/                                    # Android native code
│   ├── build.gradle                            # Android build configuration
│   ├── gradle.properties                       # Gradle properties
│   └── src/main/java/com/usesslpinning/
│       ├── SharedLogic.kt                      # Logic chung
│       ├── cli/                                # React Native CLI modules
│       │   ├── UseSslPinningModule.kt
│       │   └── UseSslPinningPackage.kt
│       └── expo/                               # Expo modules  
│           └── UseSslPinningExpoModule.kt
├── ios/                                        # iOS native code
│   ├── UseSslPinning.h                         # Main header file
│   ├── SharedLogic.swift                       # Logic chung
│   ├── cli/
│   │   └── UseSslPinningModule.swift           # React Native CLI module
│   └── expo/
│       └── UseSslPinningExpoModule.swift       # Expo module
├── src/                                        # TypeScript source
│   ├── index.tsx                               # Entry point chính
│   ├── UseSslPinning.types.ts                  # Type definitions
│   └── __tests__/                              # Test files
├── lib/                                        # Compiled output (auto-generated)
│   ├── index.js + index.d.ts                   # Compiled entry point
│   └── UseSslPinning.types.js + .d.ts          # Compiled types
├── plugin/                                     # Expo config plugin
│   ├── package.json                            # Plugin package configuration
│   └── src/
│       └── index.ts                            # TypeScript plugin source code
├── example/                                    # React Native CLI example
├── example-expo/                               # Expo example 
├── scripts/
│   └── build.sh                                # Build script
├── expo-module.config.json                     # Expo module config
├── react-native.config.js                      # React Native autolinking
├── react-native-ssl-manager.podspec            # iOS CocoaPods spec
├── package.json                                # Main package config
├── tsconfig.json                               # TypeScript configuration
├── babel.config.js                             # Babel configuration
└── README.md                                   # Main documentation
```

## Key Files and Their Purposes

### Shared Logic Files
- [android/src/main/java/com/usesslpinning/SharedLogic.kt](mdc:android/src/main/java/com/usesslpinning/SharedLogic.kt) - Android shared logic
- [ios/SharedLogic.swift](mdc:ios/SharedLogic.swift) - iOS shared logic

### React Native CLI Modules
- [android/src/main/java/com/usesslpinning/cli/UseSslPinningModule.kt](mdc:android/src/main/java/com/usesslpinning/cli/UseSslPinningModule.kt) - Android CLI module
- [android/src/main/java/com/usesslpinning/cli/UseSslPinningPackage.kt](mdc:android/src/main/java/com/usesslpinning/cli/UseSslPinningPackage.kt) - Android CLI package
- [ios/cli/UseSslPinningModule.swift](mdc:ios/cli/UseSslPinningModule.swift) - iOS CLI module

### Expo Modules
- [android/src/main/java/com/usesslpinning/expo/UseSslPinningExpoModule.kt](mdc:android/src/main/java/com/usesslpinning/expo/UseSslPinningExpoModule.kt) - Android Expo module
- [ios/expo/UseSslPinningExpoModule.swift](mdc:ios/expo/UseSslPinningExpoModule.swift) - iOS Expo module

### Configuration Files
- [expo-module.config.json](mdc:expo-module.config.json) - Expo module configuration
- [react-native.config.js](mdc:react-native.config.js) - React Native autolinking
- [ios/react-native-ssl-manager.podspec](mdc:ios/react-native-ssl-manager.podspec) - iOS CocoaPods spec
- [package.json](mdc:package.json) - Main package configuration
- [tsconfig.json](mdc:tsconfig.json) - TypeScript configuration
- [babel.config.js](mdc:babel.config.js) - Babel configuration

### JavaScript/TypeScript Interface
- [src/index.tsx](mdc:src/index.tsx) - Main TypeScript entry point
- [src/UseSslPinning.types.ts](mdc:src/UseSslPinning.types.ts) - TypeScript type definitions
- [lib/index.js + index.d.ts](mdc:lib/) - Compiled JavaScript output with type definitions

### Plugin System
- [plugin/src/index.ts](mdc:plugin/src/index.ts) - Expo config plugin
- [plugin/package.json](mdc:plugin/package.json) - Plugin package configuration

### Build and Scripts
- [scripts/build.sh](mdc:scripts/build.sh) - Build automation script

## Module Architecture

### Shared Logic
The shared logic contains common functionality used by both React Native CLI and Expo modules:
- SSL pinning state management (SharedPreferences/UserDefaults)
- Configuration parsing and validation
- Common utility functions
- TrustKit configuration (iOS)

### React Native CLI Modules
These modules use the React Native bridge API and are designed for traditional React Native CLI projects:
- Use React Native's `ReactContextBaseJavaModule` (Android)
- Use React Native's `RCTBridgeModule` protocol (iOS)
- Register with `ReactPackage` (Android) and native modules (iOS)

### Expo Modules
These modules use the Expo Modules API and are designed for Expo projects:
- Use Expo's `Module` class with `ModuleDefinition` (Android)
- Use Expo's `Module` class with `ModuleDefinition` (iOS)
- Automatically registered via `expo-module.config.json`

## Development Guidelines

1. **Always use shared logic** for common functionality to avoid code duplication
2. **Update both CLI and Expo modules** when adding new features
3. **Test on both platforms** (React Native CLI and Expo)
4. **Use TypeScript only** - All source code is written in TypeScript
5. **Follow the existing naming conventions** for consistency
6. **Keep shared logic platform-agnostic** when possible
7. **Build with `yarn build`** to generate compiled JavaScript and type definitions in `lib/`
8. **Test examples** to ensure library integration works correctly

## Build Commands

- `yarn build:all` - Build the entire project
- `yarn build:examples` - Build with examples
- `yarn typecheck` - Run TypeScript checks
- `yarn test` - Run tests
- `yarn lint` - Run linting
- `yarn clean` - Clean build artifacts

## Platform Detection

The library automatically detects whether it's running in a React Native CLI or Expo environment and uses the appropriate native module. The TypeScript API remains the same regardless of the platform. Compiled JavaScript files in `lib/` provide the runtime bridge between TypeScript and native modules.

## File Naming Conventions

- **Shared Logic**: `SharedLogic.kt` / `SharedLogic.swift`
- **CLI Modules**: `UseSslPinningModule.kt` / `UseSslPinningModule.swift`
- **Expo Modules**: `UseSslPinningExpoModule.kt` / `UseSslPinningExpoModule.swift`
- **Packages**: `UseSslPinningPackage.kt`
- **Headers**: `UseSslPinning.h`
- **Podspecs**: `react-native-ssl-manager.podspec`
